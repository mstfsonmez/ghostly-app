{"dependencies":[{"name":"./validation","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":23,"index":38},"end":{"line":3,"column":46,"index":61}}],"key":"DtGlBq654swJEbIf2z6Mk/R87pk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  const {\n    tokenChars\n  } = require(_dependencyMap[0], \"./validation\");\n\n  /**\n   * Parses the `Sec-WebSocket-Protocol` header into a set of subprotocol names.\n   *\n   * @param {String} header The field value of the header\n   * @return {Set} The subprotocol names\n   * @public\n   */\n  function parse(header) {\n    const protocols = new Set();\n    let start = -1;\n    let end = -1;\n    let i = 0;\n    for (i; i < header.length; i++) {\n      const code = header.charCodeAt(i);\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (i !== 0 && (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x2c /* ',' */) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n        if (end === -1) end = i;\n        const protocol = header.slice(start, end);\n        if (protocols.has(protocol)) {\n          throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n        }\n        protocols.add(protocol);\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    }\n    if (start === -1 || end !== -1) {\n      throw new SyntaxError('Unexpected end of input');\n    }\n    const protocol = header.slice(start, i);\n    if (protocols.has(protocol)) {\n      throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n    }\n    protocols.add(protocol);\n    return protocols;\n  }\n  module.exports = {\n    parse\n  };\n});","lineCount":54,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,8,3,6],[5,4,3,8,"tokenChars"],[6,2,3,19],[6,3,3,20],[6,6,3,23,"require"],[6,13,3,30],[6,14,3,30,"_dependencyMap"],[6,28,3,30],[6,47,3,45],[6,48,3,46],[8,2,5,0],[9,0,6,0],[10,0,7,0],[11,0,8,0],[12,0,9,0],[13,0,10,0],[14,0,11,0],[15,2,12,0],[15,11,12,9,"parse"],[15,16,12,14,"parse"],[15,17,12,15,"header"],[15,23,12,21],[15,25,12,23],[16,4,13,2],[16,10,13,8,"protocols"],[16,19,13,17],[16,22,13,20],[16,26,13,24,"Set"],[16,29,13,27],[16,30,13,28],[16,31,13,29],[17,4,14,2],[17,8,14,6,"start"],[17,13,14,11],[17,16,14,14],[17,17,14,15],[17,18,14,16],[18,4,15,2],[18,8,15,6,"end"],[18,11,15,9],[18,14,15,12],[18,15,15,13],[18,16,15,14],[19,4,16,2],[19,8,16,6,"i"],[19,9,16,7],[19,12,16,10],[19,13,16,11],[20,4,18,2],[20,9,18,7,"i"],[20,10,18,8],[20,12,18,10,"i"],[20,13,18,11],[20,16,18,14,"header"],[20,22,18,20],[20,23,18,21,"length"],[20,29,18,27],[20,31,18,29,"i"],[20,32,18,30],[20,34,18,32],[20,36,18,34],[21,6,19,4],[21,12,19,10,"code"],[21,16,19,14],[21,19,19,17,"header"],[21,25,19,23],[21,26,19,24,"charCodeAt"],[21,36,19,34],[21,37,19,35,"i"],[21,38,19,36],[21,39,19,37],[22,6,21,4],[22,10,21,8,"end"],[22,13,21,11],[22,18,21,16],[22,19,21,17],[22,20,21,18],[22,24,21,22,"tokenChars"],[22,34,21,32],[22,35,21,33,"code"],[22,39,21,37],[22,40,21,38],[22,45,21,43],[22,46,21,44],[22,48,21,46],[23,8,22,6],[23,12,22,10,"start"],[23,17,22,15],[23,22,22,20],[23,23,22,21],[23,24,22,22],[23,26,22,24,"start"],[23,31,22,29],[23,34,22,32,"i"],[23,35,22,33],[24,6,23,4],[24,7,23,5],[24,13,23,11],[24,17,24,6,"i"],[24,18,24,7],[24,23,24,12],[24,24,24,13],[24,29,25,7,"code"],[24,33,25,11],[24,38,25,16],[24,42,25,20],[24,43,25,21],[24,56,25,34,"code"],[24,60,25,38],[24,65,25,43],[24,69,25,47],[24,70,25,48],[24,71,25,49],[24,83,26,6],[25,8,27,6],[25,12,27,10,"end"],[25,15,27,13],[25,20,27,18],[25,21,27,19],[25,22,27,20],[25,26,27,24,"start"],[25,31,27,29],[25,36,27,34],[25,37,27,35],[25,38,27,36],[25,40,27,38,"end"],[25,43,27,41],[25,46,27,44,"i"],[25,47,27,45],[26,6,28,4],[26,7,28,5],[26,13,28,11],[26,17,28,15,"code"],[26,21,28,19],[26,26,28,24],[26,30,28,28],[26,31,28,29],[26,42,28,40],[27,8,29,6],[27,12,29,10,"start"],[27,17,29,15],[27,22,29,20],[27,23,29,21],[27,24,29,22],[27,26,29,24],[28,10,30,8],[28,16,30,14],[28,20,30,18,"SyntaxError"],[28,31,30,29],[28,32,30,30],[28,65,30,63,"i"],[28,66,30,64],[28,68,30,66],[28,69,30,67],[29,8,31,6],[30,8,33,6],[30,12,33,10,"end"],[30,15,33,13],[30,20,33,18],[30,21,33,19],[30,22,33,20],[30,24,33,22,"end"],[30,27,33,25],[30,30,33,28,"i"],[30,31,33,29],[31,8,35,6],[31,14,35,12,"protocol"],[31,22,35,20],[31,25,35,23,"header"],[31,31,35,29],[31,32,35,30,"slice"],[31,37,35,35],[31,38,35,36,"start"],[31,43,35,41],[31,45,35,43,"end"],[31,48,35,46],[31,49,35,47],[32,8,37,6],[32,12,37,10,"protocols"],[32,21,37,19],[32,22,37,20,"has"],[32,25,37,23],[32,26,37,24,"protocol"],[32,34,37,32],[32,35,37,33],[32,37,37,35],[33,10,38,8],[33,16,38,14],[33,20,38,18,"SyntaxError"],[33,31,38,29],[33,32,38,30],[33,40,38,38,"protocol"],[33,48,38,46],[33,77,38,75],[33,78,38,76],[34,8,39,6],[35,8,41,6,"protocols"],[35,17,41,15],[35,18,41,16,"add"],[35,21,41,19],[35,22,41,20,"protocol"],[35,30,41,28],[35,31,41,29],[36,8,42,6,"start"],[36,13,42,11],[36,16,42,14,"end"],[36,19,42,17],[36,22,42,20],[36,23,42,21],[36,24,42,22],[37,6,43,4],[37,7,43,5],[37,13,43,11],[38,8,44,6],[38,14,44,12],[38,18,44,16,"SyntaxError"],[38,29,44,27],[38,30,44,28],[38,63,44,61,"i"],[38,64,44,62],[38,66,44,64],[38,67,44,65],[39,6,45,4],[40,4,46,2],[41,4,48,2],[41,8,48,6,"start"],[41,13,48,11],[41,18,48,16],[41,19,48,17],[41,20,48,18],[41,24,48,22,"end"],[41,27,48,25],[41,32,48,30],[41,33,48,31],[41,34,48,32],[41,36,48,34],[42,6,49,4],[42,12,49,10],[42,16,49,14,"SyntaxError"],[42,27,49,25],[42,28,49,26],[42,53,49,51],[42,54,49,52],[43,4,50,2],[44,4,52,2],[44,10,52,8,"protocol"],[44,18,52,16],[44,21,52,19,"header"],[44,27,52,25],[44,28,52,26,"slice"],[44,33,52,31],[44,34,52,32,"start"],[44,39,52,37],[44,41,52,39,"i"],[44,42,52,40],[44,43,52,41],[45,4,54,2],[45,8,54,6,"protocols"],[45,17,54,15],[45,18,54,16,"has"],[45,21,54,19],[45,22,54,20,"protocol"],[45,30,54,28],[45,31,54,29],[45,33,54,31],[46,6,55,4],[46,12,55,10],[46,16,55,14,"SyntaxError"],[46,27,55,25],[46,28,55,26],[46,36,55,34,"protocol"],[46,44,55,42],[46,73,55,71],[46,74,55,72],[47,4,56,2],[48,4,58,2,"protocols"],[48,13,58,11],[48,14,58,12,"add"],[48,17,58,15],[48,18,58,16,"protocol"],[48,26,58,24],[48,27,58,25],[49,4,59,2],[49,11,59,9,"protocols"],[49,20,59,18],[50,2,60,0],[51,2,62,0,"module"],[51,8,62,6],[51,9,62,7,"exports"],[51,16,62,14],[51,19,62,17],[52,4,62,19,"parse"],[53,2,62,25],[53,3,62,26],[54,0,62,27],[54,3]],"functionMap":{"names":["<global>","parse"],"mappings":"AAA;ACW;CDgD"},"hasCjsExports":true},"type":"js/module"}]}