{"dependencies":[{"name":"../transport.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":44,"index":44}}],"key":"q68AWRvh2qc0QUlp41HSOL9aMUA=","exportNames":["*"],"imports":1}},{"name":"../util.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":45},"end":{"line":2,"column":48,"index":93}}],"key":"kanFP5HUYYYoVhDf3d7saim1ZXY=","exportNames":["*"],"imports":1}},{"name":"engine.io-parser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":94},"end":{"line":3,"column":48,"index":142}}],"key":"IB5HY76c7xC+tDEPCV8b/nK76DU=","exportNames":["*"],"imports":1}},{"name":"../globals.node.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":143},"end":{"line":4,"column":76,"index":219}}],"key":"RPWURBgga4vfm2ZRigByneogh6w=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"BaseWS\", {\n    enumerable: true,\n    get: function () {\n      return BaseWS;\n    }\n  });\n  Object.defineProperty(exports, \"WS\", {\n    enumerable: true,\n    get: function () {\n      return WS;\n    }\n  });\n  var _transportJs = require(_dependencyMap[0], \"../transport.js\");\n  var _utilJs = require(_dependencyMap[1], \"../util.js\");\n  var _engineIoParser = require(_dependencyMap[2], \"engine.io-parser\");\n  var _globalsNodeJs = require(_dependencyMap[3], \"../globals.node.js\");\n  // detect ReactNative environment\n  const isReactNative = typeof navigator !== \"undefined\" && typeof navigator.product === \"string\" && navigator.product.toLowerCase() === \"reactnative\";\n  class BaseWS extends _transportJs.Transport {\n    get name() {\n      return \"websocket\";\n    }\n    doOpen() {\n      const uri = this.uri();\n      const protocols = this.opts.protocols;\n      // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n      const opts = isReactNative ? {} : (0, _utilJs.pick)(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n      if (this.opts.extraHeaders) {\n        opts.headers = this.opts.extraHeaders;\n      }\n      try {\n        this.ws = this.createSocket(uri, protocols, opts);\n      } catch (err) {\n        return this.emitReserved(\"error\", err);\n      }\n      this.ws.binaryType = this.socket.binaryType;\n      this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n      this.ws.onopen = () => {\n        if (this.opts.autoUnref) {\n          this.ws._socket.unref();\n        }\n        this.onOpen();\n      };\n      this.ws.onclose = closeEvent => this.onClose({\n        description: \"websocket connection closed\",\n        context: closeEvent\n      });\n      this.ws.onmessage = ev => this.onData(ev.data);\n      this.ws.onerror = e => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n      this.writable = false;\n      // encodePacket efficient as it uses WS framing\n      // no need for encodePayload\n      for (let i = 0; i < packets.length; i++) {\n        const packet = packets[i];\n        const lastPacket = i === packets.length - 1;\n        (0, _engineIoParser.encodePacket)(packet, this.supportsBinary, data => {\n          // Sometimes the websocket has already been closed but the browser didn't\n          // have a chance of informing us about it yet, in that case send will\n          // throw an error\n          try {\n            this.doWrite(packet, data);\n          } catch (e) {}\n          if (lastPacket) {\n            // fake drain\n            // defer to next tick to allow Socket to clear writeBuffer\n            (0, _globalsNodeJs.nextTick)(() => {\n              this.writable = true;\n              this.emitReserved(\"drain\");\n            }, this.setTimeoutFn);\n          }\n        });\n      }\n    }\n    doClose() {\n      if (typeof this.ws !== \"undefined\") {\n        this.ws.onerror = () => {};\n        this.ws.close();\n        this.ws = null;\n      }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n      const schema = this.opts.secure ? \"wss\" : \"ws\";\n      const query = this.query || {};\n      // append timestamp to URI\n      if (this.opts.timestampRequests) {\n        query[this.opts.timestampParam] = (0, _utilJs.randomString)();\n      }\n      // communicate binary support capabilities\n      if (!this.supportsBinary) {\n        query.b64 = 1;\n      }\n      return this.createUri(schema, query);\n    }\n  }\n  const WebSocketCtor = _globalsNodeJs.globalThisShim.WebSocket || _globalsNodeJs.globalThisShim.MozWebSocket;\n  /**\n   * WebSocket transport based on the built-in `WebSocket` object.\n   *\n   * Usage: browser, Node.js (since v21), Deno, Bun\n   *\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n   * @see https://caniuse.com/mdn-api_websocket\n   * @see https://nodejs.org/api/globals.html#websocket\n   */\n  class WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n      return !isReactNative ? protocols ? new WebSocketCtor(uri, protocols) : new WebSocketCtor(uri) : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n      this.ws.send(data);\n    }\n  }\n});","lineCount":133,"map":[[7,2,9,0,"Object"],[7,8,9,0],[7,9,9,0,"defineProperty"],[7,23,9,0],[7,24,9,0,"exports"],[7,31,9,0],[8,4,9,0,"enumerable"],[8,14,9,0],[9,4,9,0,"get"],[9,7,9,0],[9,18,9,0,"get"],[9,19,9,0],[10,6,9,0],[10,13,9,0,"BaseWS"],[10,19,9,0],[11,4,9,0],[12,2,9,0],[13,2,114,0,"Object"],[13,8,114,0],[13,9,114,0,"defineProperty"],[13,23,114,0],[13,24,114,0,"exports"],[13,31,114,0],[14,4,114,0,"enumerable"],[14,14,114,0],[15,4,114,0,"get"],[15,7,114,0],[15,18,114,0,"get"],[15,19,114,0],[16,6,114,0],[16,13,114,0,"WS"],[16,15,114,0],[17,4,114,0],[18,2,114,0],[19,2,1,0],[19,6,1,0,"_transportJs"],[19,18,1,0],[19,21,1,0,"require"],[19,28,1,0],[19,29,1,0,"_dependencyMap"],[19,43,1,0],[20,2,2,0],[20,6,2,0,"_utilJs"],[20,13,2,0],[20,16,2,0,"require"],[20,23,2,0],[20,24,2,0,"_dependencyMap"],[20,38,2,0],[21,2,3,0],[21,6,3,0,"_engineIoParser"],[21,21,3,0],[21,24,3,0,"require"],[21,31,3,0],[21,32,3,0,"_dependencyMap"],[21,46,3,0],[22,2,4,0],[22,6,4,0,"_globalsNodeJs"],[22,20,4,0],[22,23,4,0,"require"],[22,30,4,0],[22,31,4,0,"_dependencyMap"],[22,45,4,0],[23,2,5,0],[24,2,6,0],[24,8,6,6,"isReactNative"],[24,21,6,19],[24,24,6,22],[24,31,6,29,"navigator"],[24,40,6,38],[24,45,6,43],[24,56,6,54],[24,60,7,4],[24,67,7,11,"navigator"],[24,76,7,20],[24,77,7,21,"product"],[24,84,7,28],[24,89,7,33],[24,97,7,41],[24,101,8,4,"navigator"],[24,110,8,13],[24,111,8,14,"product"],[24,118,8,21],[24,119,8,22,"toLowerCase"],[24,130,8,33],[24,131,8,34],[24,132,8,35],[24,137,8,40],[24,150,8,53],[25,2,9,7],[25,8,9,13,"BaseWS"],[25,14,9,19],[25,23,9,28,"Transport"],[25,35,9,37],[25,36,9,37,"Transport"],[25,45,9,37],[25,46,9,38],[26,4,10,4],[26,8,10,8,"name"],[26,12,10,12,"name"],[26,13,10,12],[26,15,10,15],[27,6,11,8],[27,13,11,15],[27,24,11,26],[28,4,12,4],[29,4,13,4,"doOpen"],[29,10,13,10,"doOpen"],[29,11,13,10],[29,13,13,13],[30,6,14,8],[30,12,14,14,"uri"],[30,15,14,17],[30,18,14,20],[30,22,14,24],[30,23,14,25,"uri"],[30,26,14,28],[30,27,14,29],[30,28,14,30],[31,6,15,8],[31,12,15,14,"protocols"],[31,21,15,23],[31,24,15,26],[31,28,15,30],[31,29,15,31,"opts"],[31,33,15,35],[31,34,15,36,"protocols"],[31,43,15,45],[32,6,16,8],[33,6,17,8],[33,12,17,14,"opts"],[33,16,17,18],[33,19,17,21,"isReactNative"],[33,32,17,34],[33,35,18,14],[33,36,18,15],[33,37,18,16],[33,40,19,14],[33,44,19,14,"pick"],[33,51,19,18],[33,52,19,18,"pick"],[33,56,19,18],[33,58,19,19],[33,62,19,23],[33,63,19,24,"opts"],[33,67,19,28],[33,69,19,30],[33,76,19,37],[33,78,19,39],[33,97,19,58],[33,99,19,60],[33,104,19,65],[33,106,19,67],[33,111,19,72],[33,113,19,74],[33,125,19,86],[33,127,19,88],[33,133,19,94],[33,135,19,96],[33,139,19,100],[33,141,19,102],[33,150,19,111],[33,152,19,113],[33,172,19,133],[33,174,19,135],[33,188,19,149],[33,190,19,151],[33,207,19,168],[33,209,19,170],[33,217,19,178],[33,219,19,180],[33,231,19,192],[33,233,19,194],[33,241,19,202],[33,243,19,204],[33,264,19,225],[33,265,19,226],[34,6,20,8],[34,10,20,12],[34,14,20,16],[34,15,20,17,"opts"],[34,19,20,21],[34,20,20,22,"extraHeaders"],[34,32,20,34],[34,34,20,36],[35,8,21,12,"opts"],[35,12,21,16],[35,13,21,17,"headers"],[35,20,21,24],[35,23,21,27],[35,27,21,31],[35,28,21,32,"opts"],[35,32,21,36],[35,33,21,37,"extraHeaders"],[35,45,21,49],[36,6,22,8],[37,6,23,8],[37,10,23,12],[38,8,24,12],[38,12,24,16],[38,13,24,17,"ws"],[38,15,24,19],[38,18,24,22],[38,22,24,26],[38,23,24,27,"createSocket"],[38,35,24,39],[38,36,24,40,"uri"],[38,39,24,43],[38,41,24,45,"protocols"],[38,50,24,54],[38,52,24,56,"opts"],[38,56,24,60],[38,57,24,61],[39,6,25,8],[39,7,25,9],[39,8,26,8],[39,15,26,15,"err"],[39,18,26,18],[39,20,26,20],[40,8,27,12],[40,15,27,19],[40,19,27,23],[40,20,27,24,"emitReserved"],[40,32,27,36],[40,33,27,37],[40,40,27,44],[40,42,27,46,"err"],[40,45,27,49],[40,46,27,50],[41,6,28,8],[42,6,29,8],[42,10,29,12],[42,11,29,13,"ws"],[42,13,29,15],[42,14,29,16,"binaryType"],[42,24,29,26],[42,27,29,29],[42,31,29,33],[42,32,29,34,"socket"],[42,38,29,40],[42,39,29,41,"binaryType"],[42,49,29,51],[43,6,30,8],[43,10,30,12],[43,11,30,13,"addEventListeners"],[43,28,30,30],[43,29,30,31],[43,30,30,32],[44,4,31,4],[45,4,32,4],[46,0,33,0],[47,0,34,0],[48,0,35,0],[49,0,36,0],[50,4,37,4,"addEventListeners"],[50,21,37,21,"addEventListeners"],[50,22,37,21],[50,24,37,24],[51,6,38,8],[51,10,38,12],[51,11,38,13,"ws"],[51,13,38,15],[51,14,38,16,"onopen"],[51,20,38,22],[51,23,38,25],[51,29,38,31],[52,8,39,12],[52,12,39,16],[52,16,39,20],[52,17,39,21,"opts"],[52,21,39,25],[52,22,39,26,"autoUnref"],[52,31,39,35],[52,33,39,37],[53,10,40,16],[53,14,40,20],[53,15,40,21,"ws"],[53,17,40,23],[53,18,40,24,"_socket"],[53,25,40,31],[53,26,40,32,"unref"],[53,31,40,37],[53,32,40,38],[53,33,40,39],[54,8,41,12],[55,8,42,12],[55,12,42,16],[55,13,42,17,"onOpen"],[55,19,42,23],[55,20,42,24],[55,21,42,25],[56,6,43,8],[56,7,43,9],[57,6,44,8],[57,10,44,12],[57,11,44,13,"ws"],[57,13,44,15],[57,14,44,16,"onclose"],[57,21,44,23],[57,24,44,27,"closeEvent"],[57,34,44,37],[57,38,44,42],[57,42,44,46],[57,43,44,47,"onClose"],[57,50,44,54],[57,51,44,55],[58,8,45,12,"description"],[58,19,45,23],[58,21,45,25],[58,50,45,54],[59,8,46,12,"context"],[59,15,46,19],[59,17,46,21,"closeEvent"],[60,6,47,8],[60,7,47,9],[60,8,47,10],[61,6,48,8],[61,10,48,12],[61,11,48,13,"ws"],[61,13,48,15],[61,14,48,16,"onmessage"],[61,23,48,25],[61,26,48,29,"ev"],[61,28,48,31],[61,32,48,36],[61,36,48,40],[61,37,48,41,"onData"],[61,43,48,47],[61,44,48,48,"ev"],[61,46,48,50],[61,47,48,51,"data"],[61,51,48,55],[61,52,48,56],[62,6,49,8],[62,10,49,12],[62,11,49,13,"ws"],[62,13,49,15],[62,14,49,16,"onerror"],[62,21,49,23],[62,24,49,27,"e"],[62,25,49,28],[62,29,49,33],[62,33,49,37],[62,34,49,38,"onError"],[62,41,49,45],[62,42,49,46],[62,59,49,63],[62,61,49,65,"e"],[62,62,49,66],[62,63,49,67],[63,4,50,4],[64,4,51,4,"write"],[64,9,51,9,"write"],[64,10,51,10,"packets"],[64,17,51,17],[64,19,51,19],[65,6,52,8],[65,10,52,12],[65,11,52,13,"writable"],[65,19,52,21],[65,22,52,24],[65,27,52,29],[66,6,53,8],[67,6,54,8],[68,6,55,8],[68,11,55,13],[68,15,55,17,"i"],[68,16,55,18],[68,19,55,21],[68,20,55,22],[68,22,55,24,"i"],[68,23,55,25],[68,26,55,28,"packets"],[68,33,55,35],[68,34,55,36,"length"],[68,40,55,42],[68,42,55,44,"i"],[68,43,55,45],[68,45,55,47],[68,47,55,49],[69,8,56,12],[69,14,56,18,"packet"],[69,20,56,24],[69,23,56,27,"packets"],[69,30,56,34],[69,31,56,35,"i"],[69,32,56,36],[69,33,56,37],[70,8,57,12],[70,14,57,18,"lastPacket"],[70,24,57,28],[70,27,57,31,"i"],[70,28,57,32],[70,33,57,37,"packets"],[70,40,57,44],[70,41,57,45,"length"],[70,47,57,51],[70,50,57,54],[70,51,57,55],[71,8,58,12],[71,12,58,12,"encodePacket"],[71,27,58,24],[71,28,58,24,"encodePacket"],[71,40,58,24],[71,42,58,25,"packet"],[71,48,58,31],[71,50,58,33],[71,54,58,37],[71,55,58,38,"supportsBinary"],[71,69,58,52],[71,71,58,55,"data"],[71,75,58,59],[71,79,58,64],[72,10,59,16],[73,10,60,16],[74,10,61,16],[75,10,62,16],[75,14,62,20],[76,12,63,20],[76,16,63,24],[76,17,63,25,"doWrite"],[76,24,63,32],[76,25,63,33,"packet"],[76,31,63,39],[76,33,63,41,"data"],[76,37,63,45],[76,38,63,46],[77,10,64,16],[77,11,64,17],[77,12,65,16],[77,19,65,23,"e"],[77,20,65,24],[77,22,65,26],[77,23,66,16],[78,10,67,16],[78,14,67,20,"lastPacket"],[78,24,67,30],[78,26,67,32],[79,12,68,20],[80,12,69,20],[81,12,70,20],[81,16,70,20,"nextTick"],[81,30,70,28],[81,31,70,28,"nextTick"],[81,39,70,28],[81,41,70,29],[81,47,70,35],[82,14,71,24],[82,18,71,28],[82,19,71,29,"writable"],[82,27,71,37],[82,30,71,40],[82,34,71,44],[83,14,72,24],[83,18,72,28],[83,19,72,29,"emitReserved"],[83,31,72,41],[83,32,72,42],[83,39,72,49],[83,40,72,50],[84,12,73,20],[84,13,73,21],[84,15,73,23],[84,19,73,27],[84,20,73,28,"setTimeoutFn"],[84,32,73,40],[84,33,73,41],[85,10,74,16],[86,8,75,12],[86,9,75,13],[86,10,75,14],[87,6,76,8],[88,4,77,4],[89,4,78,4,"doClose"],[89,11,78,11,"doClose"],[89,12,78,11],[89,14,78,14],[90,6,79,8],[90,10,79,12],[90,17,79,19],[90,21,79,23],[90,22,79,24,"ws"],[90,24,79,26],[90,29,79,31],[90,40,79,42],[90,42,79,44],[91,8,80,12],[91,12,80,16],[91,13,80,17,"ws"],[91,15,80,19],[91,16,80,20,"onerror"],[91,23,80,27],[91,26,80,30],[91,32,80,36],[91,33,80,38],[91,34,80,39],[92,8,81,12],[92,12,81,16],[92,13,81,17,"ws"],[92,15,81,19],[92,16,81,20,"close"],[92,21,81,25],[92,22,81,26],[92,23,81,27],[93,8,82,12],[93,12,82,16],[93,13,82,17,"ws"],[93,15,82,19],[93,18,82,22],[93,22,82,26],[94,6,83,8],[95,4,84,4],[96,4,85,4],[97,0,86,0],[98,0,87,0],[99,0,88,0],[100,0,89,0],[101,4,90,4,"uri"],[101,7,90,7,"uri"],[101,8,90,7],[101,10,90,10],[102,6,91,8],[102,12,91,14,"schema"],[102,18,91,20],[102,21,91,23],[102,25,91,27],[102,26,91,28,"opts"],[102,30,91,32],[102,31,91,33,"secure"],[102,37,91,39],[102,40,91,42],[102,45,91,47],[102,48,91,50],[102,52,91,54],[103,6,92,8],[103,12,92,14,"query"],[103,17,92,19],[103,20,92,22],[103,24,92,26],[103,25,92,27,"query"],[103,30,92,32],[103,34,92,36],[103,35,92,37],[103,36,92,38],[104,6,93,8],[105,6,94,8],[105,10,94,12],[105,14,94,16],[105,15,94,17,"opts"],[105,19,94,21],[105,20,94,22,"timestampRequests"],[105,37,94,39],[105,39,94,41],[106,8,95,12,"query"],[106,13,95,17],[106,14,95,18],[106,18,95,22],[106,19,95,23,"opts"],[106,23,95,27],[106,24,95,28,"timestampParam"],[106,38,95,42],[106,39,95,43],[106,42,95,46],[106,46,95,46,"randomString"],[106,53,95,58],[106,54,95,58,"randomString"],[106,66,95,58],[106,68,95,59],[106,69,95,60],[107,6,96,8],[108,6,97,8],[109,6,98,8],[109,10,98,12],[109,11,98,13],[109,15,98,17],[109,16,98,18,"supportsBinary"],[109,30,98,32],[109,32,98,34],[110,8,99,12,"query"],[110,13,99,17],[110,14,99,18,"b64"],[110,17,99,21],[110,20,99,24],[110,21,99,25],[111,6,100,8],[112,6,101,8],[112,13,101,15],[112,17,101,19],[112,18,101,20,"createUri"],[112,27,101,29],[112,28,101,30,"schema"],[112,34,101,36],[112,36,101,38,"query"],[112,41,101,43],[112,42,101,44],[113,4,102,4],[114,2,103,0],[115,2,104,0],[115,8,104,6,"WebSocketCtor"],[115,21,104,19],[115,24,104,22,"globalThis"],[115,38,104,32],[115,39,104,32,"globalThisShim"],[115,53,104,32],[115,54,104,33,"WebSocket"],[115,63,104,42],[115,67,104,46,"globalThis"],[115,81,104,56],[115,82,104,56,"globalThisShim"],[115,96,104,56],[115,97,104,57,"MozWebSocket"],[115,109,104,69],[116,2,105,0],[117,0,106,0],[118,0,107,0],[119,0,108,0],[120,0,109,0],[121,0,110,0],[122,0,111,0],[123,0,112,0],[124,0,113,0],[125,2,114,7],[125,8,114,13,"WS"],[125,10,114,15],[125,19,114,24,"BaseWS"],[125,25,114,30],[125,26,114,31],[126,4,115,4,"createSocket"],[126,16,115,16,"createSocket"],[126,17,115,17,"uri"],[126,20,115,20],[126,22,115,22,"protocols"],[126,31,115,31],[126,33,115,33,"opts"],[126,37,115,37],[126,39,115,39],[127,6,116,8],[127,13,116,15],[127,14,116,16,"isReactNative"],[127,27,116,29],[127,30,117,14,"protocols"],[127,39,117,23],[127,42,118,18],[127,46,118,22,"WebSocketCtor"],[127,59,118,35],[127,60,118,36,"uri"],[127,63,118,39],[127,65,118,41,"protocols"],[127,74,118,50],[127,75,118,51],[127,78,119,18],[127,82,119,22,"WebSocketCtor"],[127,95,119,35],[127,96,119,36,"uri"],[127,99,119,39],[127,100,119,40],[127,103,120,14],[127,107,120,18,"WebSocketCtor"],[127,120,120,31],[127,121,120,32,"uri"],[127,124,120,35],[127,126,120,37,"protocols"],[127,135,120,46],[127,137,120,48,"opts"],[127,141,120,52],[127,142,120,53],[128,4,121,4],[129,4,122,4,"doWrite"],[129,11,122,11,"doWrite"],[129,12,122,12,"_packet"],[129,19,122,19],[129,21,122,21,"data"],[129,25,122,25],[129,27,122,27],[130,6,123,8],[130,10,123,12],[130,11,123,13,"ws"],[130,13,123,15],[130,14,123,16,"send"],[130,18,123,20],[130,19,123,21,"data"],[130,23,123,25],[130,24,123,26],[131,4,124,4],[132,2,125,0],[133,0,125,1],[133,3]],"functionMap":{"names":["<global>","BaseWS","BaseWS#get__name","BaseWS#doOpen","BaseWS#addEventListeners","ws.onopen","ws.onclose","ws.onmessage","ws.onerror","BaseWS#write","encodePacket$argument_2","nextTick$argument_0","BaseWS#doClose","BaseWS#uri","WS","WS#createSocket","WS#doWrite"],"mappings":"AAA;OCQ;ICC;KDE;IEC;KFkB;IGM;yBCC;SDK;0BEC;UFG;4BGC,4BH;0BIC,yCJ;KHC;IQC;sDCO;6BCY;qBDG;aDE;KRE;IWC;8BJE,SI;KXI;IYM;KZY;CDC;OcW;ICC;KDM;IEC;KFE;CdC"},"hasCjsExports":false},"type":"js/module"}]}